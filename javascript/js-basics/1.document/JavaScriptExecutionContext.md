# JavaScriptの実行コンテキスト

JavaScriptの実行コンテキストは、コードが実行される環境を定義する抽象的な概念です。以下に主な種類と詳細を説明します。

## 実行コンテキストの種類

1. グローバル実行コンテキスト
2. 関数実行コンテキスト
3. モジュールコンテキスト
4. ~~eval実行コンテキスト~~（evalの使用が非推奨）

## 各実行コンテキストの詳細

### 1. グローバル実行コンテキスト

- JavaScriptコードの実行開始時に作成される最初の実行コンテキスト
- プログラム全体で共有されるグローバルな変数や関数を含む
- ブラウザ環境では`window`オブジェクト、Node.js環境では`global`オブジェクトが対応
- プログラムの実行中、常に1つのみ存在する

### 2. 関数実行コンテキスト

- 関数が呼び出されるたびに新しく作成される
- 各関数呼び出しは独自の実行コンテキストを持つ
- 関数内のローカル変数、引数、内部関数などを含む
- 関数の実行完了時にコールスタックから削除される
- 関数内で別の関数が呼び出された場合、新しい実行コンテキストがコールスタックに積まれる

### 3. モジュールコンテキスト

- ECMAScript 2015 (ES6) 以降のモジュールシステムに関連する実行コンテキスト
- 各モジュールファイルは独自のモジュールコンテキストを持つ
- グローバルコンテキストとは異なる独立した環境を提供する

特徴：

- モジュールスコープ：モジュール内の宣言は、そのモジュール内でのみアクセス可能
- `import`と`export`を使用してモジュール間でコードを共有
- 自動的にstrict modeで実行される
- モジュールのトップレベルでは`this`は`undefined`
- 遅延評価：最初に参照されたときに評価される

### 4. eval実行コンテキスト（evalの使用が非推奨）

- `eval()`関数内で実行されるコードのための特別な実行コンテキスト
- `eval()`は文字列として渡されたJavaScriptコードを実行する
- セキュリティ上のリスクがあるため、一般的には使用が推奨されない

## 実行コンテキストの重要な特徴

- 各実行コンテキストは以下の3つの主要な要素を持つ：
  1. 変数オブジェクト（VO）/ レキシカル環境：ローカル変数、関数宣言、引数などを含む
  2. スコープチェーン：現在のコンテキストから外部のコンテキストへのアクセスを定義
  3. `this`値：コンテキスト内での`this`キーワードの参照先を決定

- 実行コンテキストはコールスタックで管理される
- JavaScriptはレキシカルスコープを採用している
- クロージャは関数実行コンテキストとレキシカルスコープの特性により可能になる

実行コンテキストの理解は、変数のスコープ、`this`の挙動、クロージャなどのJavaScriptの重要な概念を把握する上で非常に重要です。これらの知識は、効率的で予測可能なコードを書く上で欠かせません。
